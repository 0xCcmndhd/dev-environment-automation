#!/bin/bash
# Backend: {{ backend }}
# Generated by Ansible for {{ ansible_hostname }}

# Environment variables with default values
POLL_SECONDS="{{ poll_seconds | default(5) }}"
LOG_PATH="{{ log_path | default('/var/log/gpu_fan_control.log') }}"
LOCK_PATH="{{ lock_path | default('/var/run/gpu_fan_control.lock') }}"
DRY_RUN="{{ dry_run | default(0) }}"

SSH_HOST="{{ ssh_host }}"
SSH_USER="{{ ssh_user }}"
SSH_KEY="{{ ssh_key }}"
FAN_STEPS="{{ fan_steps | default('35:40,42:65,48:80,55:100') }}"
FAILSAFE_PERCENT="{{ failsafe_percent | default(100) }}"
EXIT_PERCENT="{{ exit_percent | default(60) }}"

# Backend-specific
{% if backend == 'ipmi' %}
IPMI_MAX_HEX="{{ ipmi_max_hex | default('0x64') }}"
IPMI_MANUAL_ON_RAW="{{ ipmi_manual_on_raw | default('0x30 0x30 0x01 0x00') }}"
IPMI_SET_RAW_PREFIX="{{ ipmi_set_raw_prefix | default('0x30 0x30 0x02 0xff') }}"
{% else %}
PWM_PATHS="{{ pwm_paths | default('/sys/devices/platform/nct6775.2592/hwmon/hwmon4/pwm2 /sys/devices/platform/nct6775.2592/hwmon/hwmon4/pwm3') }}"
{% endif %}


